/* Copyright (C) YOOtheme GmbH, https://www.gnu.org/licenses/gpl.html GNU/GPL */

/**
 * @license Lightbox Plugin is based on Fancybox (http://fancybox.net, Janis Skarnelis, MIT License)
 */(function($){var plugin,tmp,loading,overlay,wrap,outer,content,close,title,nav_left,nav_right,body_margin,selectedIndex=0,selectedOpts={},selectedArray=[],currentIndex=0,currentOpts={},currentArray=[],ajaxLoader=null,imgPreloader=new Image,loadingTimer,loadingFrame=1,imgRegExp=/\.(gif|a?png|bmp|jpe?g|webp|avif)(.*)?$/i,swfRegExp=/[^\.]\.(swf)\s*$/i,youtubeRegExp=/(\/\/.*?youtube\.[a-z]+)\/watch\?v=([^&]+)&?(.*)/,youtubeRegExp2=/youtu\.be\/(.*)/,vimeoRegExp=/(\/\/.*?)vimeo\.[a-z]+\/([0-9]+).*?/,videoRegExp=/\.(mp4|ogv|webm|flv)(.*)?$/i,titleHeight=0,titleStr="",start_pos,final_pos,busy=!1,fx=$.extend($("<div/>")[0],{prop:0});_abort=function(){loading.hide(),imgPreloader.onerror=imgPreloader.onload=null,ajaxLoader&&ajaxLoader.abort(),tmp.empty()},_error=function(){if(selectedOpts.onError(selectedArray,selectedIndex,selectedOpts)===!1){loading.hide(),busy=!1;return}selectedOpts.titleShow=!1,selectedOpts.width="auto",selectedOpts.height="auto",tmp.html('<p id="lightbox-error">The requested content cannot be loaded.<br />Please try again later.</p>'),_process_inline()},_start=function(){var obj=selectedArray[selectedIndex],href,type,title,str,emb,ret;if(_abort(),selectedOpts=$.extend({},plugin.defaults,typeof $(obj).data(plugin.name)=="undefined"?selectedOpts:$(obj).data(plugin.name)),$(obj).attr("data-lightbox")&&$.each($(obj).attr("data-lightbox").split(";"),function(i,option){var opt=option.match(/\s*([A-Z_]*?)\s*:\s*(.+)\s*/i);opt&&(selectedOpts[opt[1]]=opt[2],(selectedOpts[opt[1]]==="true"||selectedOpts[opt[1]]==="false")&&(selectedOpts[opt[1]]=eval(opt[2])))}),ret=(typeof selectedOpts.onStart=="string"?window[selectedOpts.onStart]:selectedOpts.onStart)(selectedArray,selectedIndex,selectedOpts),ret===!1){busy=!1;return}else typeof ret=="object"&&(selectedOpts=$.extend(selectedOpts,ret));if(title=selectedOpts.title||(obj.nodeName?$(obj).attr("title"):obj.title)||"",obj.nodeName&&!selectedOpts.orig&&(selectedOpts.orig=$(obj).children("img:first").length?$(obj).children("img:first"):$(obj)),title===""&&selectedOpts.orig&&selectedOpts.titleFromAlt&&(title=selectedOpts.orig.attr("alt")),href=selectedOpts.href||(obj.nodeName?$(obj).attr("href"):obj.href)||null,(/^(?:javascript)/i.test(href)||href=="#")&&(href=null),selectedOpts.type)type=selectedOpts.type,href||(href=selectedOpts.content);else if(selectedOpts.content)type="html";else if(href)if(href.match(imgRegExp))type="image";else if(href.match(swfRegExp))type="swf";else if(href.match(videoRegExp))type="video";else if(href.match(youtubeRegExp))href=href.replace(youtubeRegExp,"$1/embed/$2?$3").replace("/(.*)?$/",""),type="iframe";else if(href.match(youtubeRegExp2)){var parts=href.split("/");href="https://www.youtube.com/embed/"+parts[parts.length-1],type="iframe"}else href.match(vimeoRegExp)?(href=href.replace(vimeoRegExp,"$1player.vimeo.com/video/$2"),type="iframe"):href.indexOf("http://")!=-1&&href.indexOf(location.hostname.toLowerCase())==-1?type="iframe":href.indexOf("#wk-")===0?type=window.wk_ajax_render_url?"widget":!1:href.indexOf("#")===0?type="inline":type="ajax";if(!type){_error();return}switch(type=="inline"&&(obj=href.substr(href.indexOf("#")),type=$(obj).length>0?"inline":"ajax"),selectedOpts.type=type,selectedOpts.href=href,selectedOpts.title=title,selectedOpts.autoDimensions&&selectedOpts.type!=="iframe"&&selectedOpts.type!=="swf"&&selectedOpts.type!=="video"&&selectedOpts.type!=="widget"&&(selectedOpts.width="auto",selectedOpts.height="auto"),selectedOpts.modal&&(selectedOpts.overlayShow=!0,selectedOpts.hideOnOverlayClick=!1,selectedOpts.hideOnContentClick=!1,selectedOpts.enableEscapeButton=!1,selectedOpts.showCloseButton=!1),selectedOpts.padding=parseInt(selectedOpts.padding,10),selectedOpts.margin=parseInt(selectedOpts.margin,10),tmp.css("padding",selectedOpts.padding+selectedOpts.margin),$(".lightbox-inline-tmp").unbind("lightbox-cancel").bind("lightbox-change",function(){$(this).replaceWith(content.children())}),type){case"html":tmp.html(selectedOpts.content),_process_inline();break;case"video":busy=!1,selectedOpts.scrolling="no";var vwidth=selectedOpts.width=="auto"?320:selectedOpts.width,vheight=selectedOpts.height=="auto"?240:selectedOpts.height,vattrs=[];vattrs.push('src="'+href+'"'),vattrs.push('width="'+vwidth+'"'),vattrs.push('height="'+vheight+'"'),vattrs.push('preload="none"'),$.type(selectedOpts.autoplay)!="undefined"&&vattrs.push('autoplay="'+String(selectedOpts.autoplay)+'"'),$.type(selectedOpts.controls)!="undefined"&&vattrs.push('controls="'+String(selectedOpts.controls)+'"'),$.type(selectedOpts.loop)!="undefined"&&vattrs.push('loop="'+String(selectedOpts.loop)+'"'),$.type(selectedOpts.poster)!="undefined"&&vattrs.push('poster="'+String(selectedOpts.poster)+'"'),tmp.html("<video "+vattrs.join(" ")+" /></video>"),$.fn.mediaelementplayer&&$("video",tmp).each(function(){var e=new mejs.MediaElementPlayer(this);vwidth>$(window).width()&&e.setPlayerSize("100%","100%")}),selectedOpts.width="auto",selectedOpts.height="auto",_process_inline();break;case"inline":if($(obj).parent().is("#lightbox-content")===!0){busy=!1;return}$('<div class="lightbox-inline-tmp" />').hide().insertBefore($(obj)).bind("lightbox-cleanup",function(){$(this).replaceWith(content.children())}).bind("lightbox-cancel",function(){$(this).replaceWith(tmp.children())}),$(obj).appendTo(tmp),_process_inline();break;case"image":busy=!1,plugin.showActivity(),imgPreloader=new Image,imgPreloader.onerror=function(){_error()},imgPreloader.onload=function(){busy=!0,imgPreloader.onerror=imgPreloader.onload=null,_process_image()},imgPreloader.src=href;break;case"swf":selectedOpts.scrolling="no",selectedOpts.autoDimensions=!1,str='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="'+selectedOpts.width+'" height="'+selectedOpts.height+'"><param name="movie" value="'+href+'"></param>',emb="",$.each(selectedOpts.swf,function(e,t){str+='<param name="'+e+'" value="'+t+'"></param>',emb+=" "+e+'="'+t+'"'}),str+='<embed src="'+href+'" type="application/x-shockwave-flash" width="'+selectedOpts.width+'" height="'+selectedOpts.height+'"'+emb+"></embed></object>",tmp.html(str),_process_inline();break;case"ajax":busy=!1,plugin.showActivity(),selectedOpts.ajax.win=selectedOpts.ajax.success,ajaxLoader=$.ajax($.extend({},selectedOpts.ajax,{url:href,data:selectedOpts.ajax.data||{},error:function(e,t,r){e.status>0&&_error()},success:function(e,t,r){var n=typeof r=="object"?r:ajaxLoader;if(n.status==200){if(typeof selectedOpts.ajax.win=="function")if(ret=selectedOpts.ajax.win(href,e,t,r),ret===!1){loading.hide();return}else(typeof ret=="string"||typeof ret=="object")&&(e=ret);tmp.html(e),_process_inline()}}}));break;case"widget":busy=!1,selectedOpts.autoDimensions=!1,plugin.showActivity(),selectedOpts.ajax.win=selectedOpts.ajax.success,ajaxLoader=$.ajax($.extend({},selectedOpts.ajax,{url:wk_ajax_render_url(href.split("-")[1]),data:selectedOpts.ajax.data||{},error:function(e,t,r){e.status>0&&_error()},success:function(e,t,r){var n=typeof r=="object"?r:ajaxLoader;if(n.status==200){if(typeof selectedOpts.ajax.win=="function")if(ret=selectedOpts.ajax.win(href,e,t,r),ret===!1){loading.hide();return}else(typeof ret=="string"||typeof ret=="object")&&(e=ret);tmp.html(e),_process_inline(),$widgetkit.lazyload($("#lightbox-content"))}}}));break;case"iframe":selectedOpts.autoDimensions=!1,_show();break}},_process_inline=function(){tmp.wrapInner('<div style="width:'+(selectedOpts.width=="auto"?"auto":selectedOpts.width+"px")+";height:"+(selectedOpts.height=="auto"?"auto":selectedOpts.height+"px")+";overflow: "+(selectedOpts.scrolling=="auto"?"auto":selectedOpts.scrolling=="yes"?"scroll":"hidden")+'"></div>'),selectedOpts.width=tmp.width(),selectedOpts.height=tmp.height(),_show()},_process_image=function(){selectedOpts.width=imgPreloader.width,selectedOpts.height=imgPreloader.height,$("<img />").attr({id:"lightbox-img",src:imgPreloader.src,alt:selectedOpts.title}).appendTo(tmp),_show()},_show=function(){var e,t;if(loading.hide(),wrap.is(":visible")&&currentOpts.onCleanup(currentArray,currentIndex,currentOpts)===!1){$(".lightbox-inline-tmp").trigger("lightbox-cancel"),busy=!1;return}if(busy=!0,$(content.add(overlay)).unbind(),$(window).unbind("resize.fb scroll.fb"),$(document).unbind("keydown.fb"),wrap.is(":visible")&&currentOpts.titlePosition!=="outside"&&wrap.css("height",wrap.height()),currentArray=selectedArray,currentIndex=selectedIndex,currentOpts=selectedOpts,currentOpts.overlayShow?(overlay.css({"background-color":currentOpts.overlayColor,opacity:currentOpts.overlayOpacity,cursor:currentOpts.hideOnOverlayClick?"pointer":"auto",height:$(document).height()}),overlay.is(":visible")||overlay.show()):overlay.hide(),final_pos=_get_zoom_to(),_process_title(),wrap.is(":visible")){$(close.add(nav_left).add(nav_right)).hide(),e=wrap.position(),start_pos={top:e.top,left:e.left,width:wrap.width(),height:wrap.height()},t=start_pos.width==final_pos.width&&start_pos.height==final_pos.height,content.fadeTo(currentOpts.changeFade,.3,function(){var r=function(){content.html(tmp.contents()).fadeTo(currentOpts.changeFade,1,_finish)};$(".lightbox-inline-tmp").trigger("lightbox-change"),content.empty().removeAttr("filter").css({"border-width":currentOpts.padding,width:final_pos.width-currentOpts.padding*2,height:currentOpts.type=="image"||currentOpts.type=="swf"||currentOpts.type=="iframe"?final_pos.height-titleHeight-currentOpts.padding*2:"auto"}),t?r():(fx.prop=0,$(fx).animate({prop:1},{duration:currentOpts.changeSpeed,easing:currentOpts.easingChange,step:_draw,complete:r}))});return}if(wrap.removeAttr("style"),content.css("border-width",currentOpts.padding),content.css("-webkit-transform","translateZ(0)"),currentOpts.transitionIn=="elastic"){start_pos=_get_zoom_from(),content.html(tmp.contents()),wrap.show(),currentOpts.opacity&&(final_pos.opacity=0),fx.prop=0,$(fx).animate({prop:1},{duration:currentOpts.speedIn,easing:currentOpts.easingIn,step:_draw,complete:_finish});return}currentOpts.titlePosition=="inside"&&titleHeight>0&&title.show(),content.css({width:final_pos.width-currentOpts.padding*2,height:currentOpts.type=="image"||currentOpts.type=="swf"||currentOpts.type=="iframe"?final_pos.height-titleHeight-currentOpts.padding*2:"auto"}).html(tmp.contents()),wrap.css(final_pos).fadeIn(currentOpts.transitionIn=="none"?0:currentOpts.speedIn,_finish)},_format_title=function(e){return e&&e.length?'<div id="lightbox-title-'+currentOpts.titlePosition+'">'+e+"</div>":!1},_process_title=function(){if(titleStr=currentOpts.title||"",titleHeight=0,title.empty().removeAttr("style").removeClass(),currentOpts.titleShow===!1){title.hide();return}if(titleStr=$.isFunction(currentOpts.titleFormat)?currentOpts.titleFormat(titleStr,currentArray,currentIndex,currentOpts):_format_title(titleStr),!titleStr||titleStr===""){title.hide();return}switch(title.addClass("lightbox-title-"+currentOpts.titlePosition).html(titleStr).appendTo("body").show(),currentOpts.titlePosition){case"inside":title.css({width:final_pos.width-currentOpts.padding*2,marginLeft:currentOpts.padding,marginRight:currentOpts.padding}),titleHeight=title.outerHeight(!0),title.appendTo(outer),final_pos.height+=titleHeight;break;case"over":title.css({marginLeft:currentOpts.padding,width:final_pos.width-currentOpts.padding*2,bottom:currentOpts.padding}).appendTo(outer);break;case"float":title.css("left",parseInt((title.width()-final_pos.width-40)/2,10)*-1).appendTo(wrap);break;default:title.css({width:final_pos.width-currentOpts.padding*2,paddingLeft:currentOpts.padding,paddingRight:currentOpts.padding}).appendTo(wrap);break}title.hide()},_set_navigation=function(){if((currentOpts.enableEscapeButton||currentOpts.enableKeyboardNav)&&$(document).bind("keydown.fb",function(e){e.keyCode==27&&currentOpts.enableEscapeButton?(e.preventDefault(),plugin.close()):(e.keyCode==37||e.keyCode==39)&&currentOpts.enableKeyboardNav&&e.target.tagName!=="INPUT"&&e.target.tagName!=="TEXTAREA"&&e.target.tagName!=="SELECT"&&(e.preventDefault(),plugin[e.keyCode==37?"prev":"next"]())}),!currentOpts.showNavArrows){nav_left.hide(),nav_right.hide();return}(currentOpts.cyclic&&currentArray.length>1||currentIndex!==0)&&nav_left.show(),(currentOpts.cyclic&&currentArray.length>1||currentIndex!=currentArray.length-1)&&nav_right.show()},_finish=function(){wrap.css("height","auto"),currentOpts.type!=="image"&&currentOpts.type!=="swf"&&currentOpts.type!=="iframe"&&content.css("height","auto"),titleStr&&titleStr.length&&title.show(),currentOpts.showCloseButton&&close.show(),_set_navigation(),currentOpts.hideOnContentClick&&content.bind("click",plugin.close),currentOpts.hideOnOverlayClick&&overlay.bind("click",plugin.close),$(window).bind("resize.fb",plugin.resize),currentOpts.centerOnScroll&&$(window).bind("scroll.fb",plugin.center),currentOpts.type=="iframe"&&$('<iframe id="lightbox-frame" name="lightbox-frame'+new Date().getTime()+'" frameborder="0" hspace="0" '+($.support.opacity?"":'allowtransparency="true""')+' scrolling="'+selectedOpts.scrolling+'" src="'+currentOpts.href+'"></iframe>').appendTo(content),wrap.show(),busy=!1,plugin.center(),(typeof currentOpts.onComplete=="string"?window[currentOpts.onComplete]:currentOpts.onComplete)(currentArray,currentIndex,currentOpts),_preload_images()},_preload_images=function(){var e,t;currentArray.length-1>currentIndex&&(e=currentArray[currentIndex+1].href,typeof e!="undefined"&&e.match(imgRegExp)&&(t=new Image,t.src=e)),currentIndex>0&&(e=currentArray[currentIndex-1].href,typeof e!="undefined"&&e.match(imgRegExp)&&(t=new Image,t.src=e))},_draw=function(e){var t={width:parseInt(start_pos.width+(final_pos.width-start_pos.width)*e,10),height:parseInt(start_pos.height+(final_pos.height-start_pos.height)*e,10),top:parseInt(start_pos.top+(final_pos.top-start_pos.top)*e,10),left:parseInt(start_pos.left+(final_pos.left-start_pos.left)*e,10)};typeof final_pos.opacity!="undefined"&&(t.opacity=e<.5?.5:e),wrap.css(t),content.css({width:t.width-currentOpts.padding*2,height:t.height-titleHeight*e-currentOpts.padding*2})},_get_viewport=function(){return[$(window).width()-currentOpts.margin*2,$(window).height()-currentOpts.margin*2,$(document).scrollLeft()+currentOpts.margin,$(document).scrollTop()+currentOpts.margin]},_get_zoom_to=function(){var e=_get_viewport(),t={},r=currentOpts.autoScale,n=currentOpts.padding*2,s;return currentOpts.width.toString().indexOf("%")>-1?t.width=parseInt(e[0]*parseFloat(currentOpts.width)/100,10):t.width=parseInt(currentOpts.width)+n,currentOpts.height.toString().indexOf("%")>-1?t.height=parseInt(e[1]*parseFloat(currentOpts.height)/100,10):t.height=parseInt(currentOpts.height)+n,r&&(t.width>e[0]||t.height>e[1])&&(selectedOpts.type=="image"||selectedOpts.type=="swf"?(s=currentOpts.width/currentOpts.height,t.width>e[0]&&(t.width=e[0],t.height=parseInt((t.width-n)/s+n,10)),t.height>e[1]&&(t.height=e[1],t.width=parseInt((t.height-n)*s+n,10))):(t.width=Math.min(t.width,e[0]),t.height=Math.min(t.height,e[1]))),t.top=parseInt(Math.max(e[3]-20,e[3]+(e[1]-t.height-40)*.5),10),t.left=parseInt(Math.max(e[2]-20,e[2]+(e[0]-t.width-40)*.5),10),t},_get_obj_pos=function(e){var t=e.offset();return t.top+=parseInt(e.css("paddingTop"),10)||0,t.left+=parseInt(e.css("paddingLeft"),10)||0,t.top+=parseInt(e.css("border-top-width"),10)||0,t.left+=parseInt(e.css("border-left-width"),10)||0,t.width=e.width(),t.height=e.height(),t},_get_zoom_from=function(){var e=selectedOpts.orig?$(selectedOpts.orig):!1,t={},r,n;return e&&e.length?(r=_get_obj_pos(e),t={width:r.width+currentOpts.padding*2,height:r.height+currentOpts.padding*2,top:r.top-currentOpts.padding-20,left:r.left-currentOpts.padding-20}):(n=_get_viewport(),t={width:currentOpts.padding*2,height:currentOpts.padding*2,top:parseInt(n[3]+n[1]*.5,10),left:parseInt(n[2]+n[0]*.5,10)}),t},_animate_loading=function(){if(!loading.is(":visible")){clearInterval(loadingTimer);return}$("div",loading).css("top",loadingFrame*-40+"px"),loadingFrame=(loadingFrame+1)%12};var Plugin=function(){};Plugin.prototype=$.extend(Plugin.prototype,{name:"lightbox",defaults:{padding:10,margin:40,opacity:!1,modal:!1,cyclic:!1,scrolling:"auto",width:560,height:340,autoScale:!0,autoDimensions:!0,centerOnScroll:!1,ajax:{},swf:{wmode:"transparent"},hideOnOverlayClick:!0,hideOnContentClick:!1,overlayShow:!0,overlayOpacity:.7,overlayColor:"#777",titleShow:!0,titlePosition:"float",titleFormat:null,titleFromAlt:!1,transitionIn:"fade",transitionOut:"fade",speedIn:300,speedOut:300,changeSpeed:300,changeFade:"fast",easingIn:"swing",easingOut:"swing",showCloseButton:!0,showNavArrows:!0,enableEscapeButton:!0,enableKeyboardNav:!0,onStart:function(){},onCancel:function(){},onComplete:function(){},onCleanup:function(){},onClosed:function(){},onError:function(){}},init:function(){var e=this;$("#lightbox-wrap").length||($("body").append(tmp=$('<div id="lightbox-tmp"></div>'),loading=$('<div id="lightbox-loading"><div></div></div>'),overlay=$('<div id="lightbox-overlay"></div>'),wrap=$('<div id="lightbox-wrap"></div>')),body_margin=overlay.show().position(),overlay.hide(),body_margin.top!=0&&overlay.css("top",body_margin.top*-1),outer=$('<div id="lightbox-outer"></div>').appendTo(wrap),outer.append(content=$('<div id="lightbox-content"></div>'),close=$('<a id="lightbox-close"></a>'),title=$('<div id="lightbox-title"></div>'),nav_left=$('<a href="javascript:;" id="lightbox-left"><span id="lightbox-left-ico"></span></a>'),nav_right=$('<a href="javascript:;" id="lightbox-right"><span id="lightbox-right-ico"></span></a>')),close.bind("click",this.close),loading.bind("click",this.cancel),nav_left.bind("click",function(t){t.preventDefault(),e.prev()}),nav_right.bind("click",function(t){t.preventDefault(),e.next()}),$.fn.mousewheel&&wrap.bind("mousewheel.fb",function(t,r){(busy||currentOpts.type=="image")&&t.preventDefault(),e[r>0?"prev":"next"]()}),"ontouchend"in document&&(wrap.bind("touchstart",function(t){var r=t.originalEvent.touches?t.originalEvent.touches[0]:t,n={time:new Date().getTime(),coords:[r.pageX,r.pageY],origin:$(t.target)},s;function o(a){if(n){var p=a.originalEvent.touches?a.originalEvent.touches[0]:a;s={time:new Date().getTime(),coords:[p.pageX,p.pageY]},Math.abs(n.coords[0]-s.coords[0])>10&&a.preventDefault()}}wrap.bind("touchmove",o).one("touchend",function(a){wrap.unbind("touchmove",o),n&&s&&s.time-n.time<1e3&&Math.abs(n.coords[0]-s.coords[0])>30&&Math.abs(n.coords[1]-s.coords[1])<75&&n.origin.trigger("swipe").trigger(n.coords[0]>s.coords[0]?"swipeleft":"swiperight"),n=s=void 0})}),wrap.bind("swipeleft",function(t){(busy||currentOpts.type=="image")&&t.preventDefault(),e.next()}).bind("swiperight",function(t){(busy||currentOpts.type=="image")&&t.preventDefault(),e.prev()})))},open:function(e){var t;if(!busy){if(busy=!0,t=typeof arguments[1]!="undefined"?arguments[1]:{},selectedArray=[],selectedIndex=parseInt(t.index,10)||0,$.isArray(e)){for(var r=0,n=e.length;r<n;r++)typeof e[r]=="object"?$(e[r]).data(plugin.name,$.extend({},t,e[r])):e[r]=$({}).data(plugin.name,$.extend({content:e[r]},t));selectedArray=$.merge(selectedArray,e)}else typeof e=="object"?$(e).data(plugin.name,$.extend({},t,e)):e=$({}).data(plugin.name,$.extend({content:e},t)),selectedArray.push(e);(selectedIndex>selectedArray.length||selectedIndex<0)&&(selectedIndex=0),_start()}},showActivity:function(){clearInterval(loadingTimer),loading.show(),loadingTimer=setInterval(_animate_loading,66)},hideActivity:function(){loading.hide()},next:function(){return this.pos(currentIndex+1)},prev:function(){return this.pos(currentIndex-1)},pos:function(e){busy||(e=parseInt(e),selectedArray=currentArray,e>-1&&e<currentArray.length?(selectedIndex=e,_start()):currentOpts.cyclic&&currentArray.length>1&&(selectedIndex=e>=currentArray.length?0:currentArray.length-1,_start()))},cancel:function(){busy||(busy=!0,$(".lightbox-inline-tmp").trigger("lightbox-cancel"),_abort(),selectedOpts.onCancel(selectedArray,selectedIndex,selectedOpts),busy=!1)},close:function(){if(busy||wrap.is(":hidden"))return;if(busy=!0,currentOpts&&currentOpts.onCleanup(currentArray,currentIndex,currentOpts)===!1){busy=!1;return}_abort(),$(close.add(nav_left).add(nav_right)).hide(),$(content.add(overlay)).unbind(),$(window).unbind("resize.fb scroll.fb"),$(document).unbind("keydown.fb"),content.find("iframe").attr("src","about:blank"),currentOpts.titlePosition!=="inside"&&title.empty(),wrap.stop();function e(){overlay.fadeOut("fast"),title.empty().hide(),wrap.hide(),$(".lightbox-inline-tmp").trigger("lightbox-cleanup"),content.empty(),currentOpts.onClosed(currentArray,currentIndex,currentOpts),currentArray=selectedOpts=[],currentIndex=selectedIndex=0,currentOpts=selectedOpts={},busy=!1}if(currentOpts.transitionOut=="elastic"){start_pos=_get_zoom_from();var t=wrap.position();final_pos={top:t.top,left:t.left,width:wrap.width(),height:wrap.height()},currentOpts.opacity&&(final_pos.opacity=1),title.empty().hide(),fx.prop=1,$(fx).animate({prop:0},{duration:currentOpts.speedOut,easing:currentOpts.easingOut,step:_draw,complete:e})}else wrap.fadeOut(currentOpts.transitionOut=="none"?0:currentOpts.speedOut,e)},resize:function(){switch(overlay.is(":visible")&&overlay.css("height",$(document).height()),final_pos=_get_zoom_to(),currentOpts.titlePosition){case"float":title.css("left",parseInt((title.width()-final_pos.width-40)/2,10)*-1);break;default:title.css("width",final_pos.width-currentOpts.padding*2);break}plugin.center(!0)},center:function(){var e,t;busy||(t=arguments[0]===!0?1:0,e=_get_viewport(),!(!t&&(wrap.width()>e[0]||wrap.height()>e[1]))&&wrap.stop().animate({top:parseInt(Math.max(e[3]-20,e[3]+(e[1]-content.height()-40)*.5-currentOpts.padding)),left:parseInt(Math.max(e[2]-20,e[2]+(e[0]-content.width()-40)*.5-currentOpts.padding))},typeof arguments[0]=="number"?arguments[0]:200))}}),$.fn[Plugin.prototype.name]=function(){var e=arguments,t=e[0]?e[0]:{};return this.each(function(){$(this).data(Plugin.prototype.name,t).unbind("click."+Plugin.prototype.name).bind("click."+Plugin.prototype.name,function(r){if(r.preventDefault(),!busy){busy=!0,$(this).blur(),selectedArray=[],selectedIndex=0;var n=$(this).attr("data-lightbox")||"";n&&(n=n.match(/group:([^;]+)/i))?(selectedArray=$('a[data-lightbox*="'+n[0]+'"], area[data-lightbox*="'+n[0]+'"]'),selectedIndex=selectedArray.index(this)):selectedArray.push(this),_start()}})})},$(document).ready(function(){plugin=new Plugin,plugin.init(),$[Plugin.prototype.name]=plugin})})(jQuery);
